graph TD
    %% Reference boxes (no arrows to main flow)
    Legend["ğŸ“– SYMBOLS<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>**âœ“ Real**: Use actual dependency<br/>**âŠ— Mock**: Use test double<br/>**â‡„ Toggle**: Mock dev, real verify<br/>**N/A**: Not applicable"]
    
    DepTypes["ğŸ¨ DEPENDENCY TYPES<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>**IPD** = In-Process Dependency<br/>**OOPD** = Out-of-Process Dependency<br/><br/>ğŸŸ£ Pure IPD: No side effects<br/>ğŸŸ  Impure IPD: Internal side effects<br/>ğŸŸ¢ Managed OOPD: Your resources<br/>ğŸ”µ Unmanaged OOPD: External systems"]
    
    Info["ğŸ’¡ IMPLEMENTATION TYPES<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>**Observable Behavioral**:<br/>Business logic & use cases<br/><br/>**Non-Observable Technical**:<br/>Infrastructure & adapters<br/><br/>**Observable Technical**:<br/>Pure presentation (UI/UX)"]
    
    %% Main decision flow
    Start["Should I mock this dependency?"]
    
    Start --> Q1{"What are you<br/>building?"}
    
    Q1 -->|Observable<br/>Behavioral| BehaviorSplit{"Test scope?"}
    Q1 -->|Non-Observable<br/>Technical| TechSplit{"Dependency<br/>category?"}
    Q1 -->|Observable<br/>Technical| Visual["ğŸ‘ï¸ Visual/Sensory Validation<br/>â”€â”€â”€â”€<br/>No mocking applicable"]
    
    BehaviorSplit -->|Single unit| UnitChoice["ğŸ”¬ Unit Test"]
    BehaviorSplit -->|Full system| AccChoice["ğŸ¯ Acceptance Test"]
    
    TechSplit -->|Managed OOPD| IntChoice["ğŸ”Œ Integration Test"]
    TechSplit -->|Unmanaged OOPD| ContractRoute{"Governed or External?"}
    
    ContractRoute -->|Governed| BiChoice["ğŸ¤ Bidirectional Contract"]
    ContractRoute -->|External| UniChoice["â¡ï¸ Unidirectional Contract"]
    
    %% Compact answer nodes
    UnitChoice --> UnitAnswer["ğŸ”¬ UNIT TEST<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>ğŸŸ£ Pure IPD â†’ âœ“ Real<br/>ğŸŸ  Impure IPD â†’ âŠ— Mock<br/>ğŸŸ¢ Managed OOPD â†’ âŠ— Mock<br/>ğŸ”µ Unmanaged OOPD â†’ âŠ— Mock"]
    
    IntChoice --> IntAnswer["ğŸ”Œ INTEGRATION TEST<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>ğŸŸ£ Pure IPD â†’ âœ“ Real<br/>ğŸŸ  Impure IPD â†’ âœ“/âŠ— (if stable)*<br/>ğŸŸ¢ Managed OOPD â†’ âœ“ Real<br/>ğŸ”µ Unmanaged OOPD â†’ âŠ— Mock"]
    
    BiChoice --> BiAnswer["ğŸ¤ BIDIRECTIONAL CONTRACT<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>ğŸŸ£ Pure IPD â†’ âœ“ Real<br/>ğŸŸ  Impure IPD â†’ âœ“/âŠ— (if stable)*<br/>ğŸŸ¢ Managed OOPD â†’ âŠ— Mock**<br/>ğŸ”µ Governed â†’ â‡„ Toggle<br/>ğŸ”µ External â†’ N/A"]
    
    UniChoice --> UniAnswer["â¡ï¸ UNIDIRECTIONAL CONTRACT<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>ğŸŸ£ Pure IPD â†’ âœ“ Real<br/>ğŸŸ  Impure IPD â†’ âœ“/âŠ— (if stable)*<br/>ğŸŸ¢ Managed OOPD â†’ âŠ— Mock**<br/>ğŸ”µ Governed â†’ N/A<br/>ğŸ”µ External â†’ â‡„ Toggle"]
    
    AccChoice --> AccAnswer["ğŸ¯ ACCEPTANCE TEST<br/>â”€â”€â”€â”€â”€â”€â”€â”€<br/>ğŸŸ£ Pure IPD â†’ âœ“ Real<br/>ğŸŸ  Impure IPD â†’ âœ“ Real<br/>ğŸŸ¢ Managed OOPD â†’ âœ“ Real (all)<br/>ğŸ”µ Unmanaged OOPD â†’ âŠ— Mock"]
    
    %% Footnotes
    Footnotes["* If stable and reliable<br/>** Focus on contract, not infrastructure"]
    
    %% Styling - minimal, functional only
    style Legend fill:#fff9c4,stroke:#f9a825,stroke-width:2px,color:#000
    style DepTypes fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    style Info fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000
    style Footnotes fill:#f5f5f5,stroke:#999,stroke-width:1px,color:#666
    
    style Start fill:#f5f5f5,stroke:#333,stroke-width:3px,color:#000
    style Q1 fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000
    style BehaviorSplit fill:#fff,stroke:#666,stroke-width:1px,color:#000
    style TechSplit fill:#fff,stroke:#666,stroke-width:1px,color:#000
    style ContractRoute fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000
    
    style Visual fill:#f5f5f5,stroke:#999,stroke-width:2px,color:#000
    style UnitChoice fill:#fff,stroke:#333,stroke-width:2px,color:#000
    style IntChoice fill:#fff,stroke:#333,stroke-width:2px,color:#000
    style BiChoice fill:#fff,stroke:#333,stroke-width:2px,color:#000
    style UniChoice fill:#fff,stroke:#333,stroke-width:2px,color:#000
    style AccChoice fill:#fff,stroke:#333,stroke-width:2px,color:#000
    
    style UnitAnswer fill:#f5f5f5,stroke:#333,stroke-width:2px,color:#000
    style IntAnswer fill:#f5f5f5,stroke:#333,stroke-width:2px,color:#000
    style BiAnswer fill:#f5f5f5,stroke:#333,stroke-width:2px,color:#000
    style UniAnswer fill:#f5f5f5,stroke:#333,stroke-width:2px,color:#000
    style AccAnswer fill:#f5f5f5,stroke:#333,stroke-width:2px,color:#000